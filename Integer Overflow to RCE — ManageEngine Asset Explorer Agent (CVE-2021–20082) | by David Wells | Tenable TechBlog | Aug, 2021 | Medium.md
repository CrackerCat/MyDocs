> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [medium.com](https://medium.com/tenable-techblog/integer-overflow-to-rce-manageengine-asset-explorer-agent-cve-2021-20082-7e54cb2caad5)

> A couple months back, Chris Lyne and I had a look at ManageEngine ServiceDesk Plus. This product cons......

Integer Overflow to RCE — ManageEngine Asset Explorer Agent (CVE-2021–20082)
============================================================================

[![](https://miro.medium.com/fit/c/96/96/2*GElu1JH-bOYu09XyXeWmpA.jpeg)](/@CE2Wells?source=post_page-----7e54cb2caad5--------------------------------)[David Wells](/@CE2Wells?source=post_page-----7e54cb2caad5--------------------------------)Follow[Aug 17](/tenable-techblog/integer-overflow-to-rce-manageengine-asset-explorer-agent-cve-2021-20082-7e54cb2caad5?source=post_page-----7e54cb2caad5--------------------------------) · 14 min read

A couple months back, Chris Lyne and I had a look at ManageEngine ServiceDesk Plus. This product consists of a server / agent model in which agents provide updates on machine status back to the Manage Engine server. Chris ended up finding an unauth XSS-to-RCE chain in the server component which you can read here: [https://medium.com/tenable-techblog/stored-xss-to-rce-chain-as-system-in-manageengine-servicedesk-plus-493c10f3e444](/tenable-techblog/stored-xss-to-rce-chain-as-system-in-manageengine-servicedesk-plus-493c10f3e444), allowing an attacker to fully compromise the server with SYSTEM privileges.

The blog here will go over the exploitation of an integer overflow that I found in the agents themselves (CVE-2021–20082) called Asset Explorer Agent. This exploit could allow an attacker to pivot the network once the ManageEngine server is compromised. Alternatively, this could be exploited by spoofing the ManageEngine server IP on the network and triggering this vulnerability as we will touch on later. While this PoC is not super reliable, it has been proven to work after several tries on a Windows 10 Pro 20H2 box (see below). I believe that further work on heap grooming could increase exploitation odds.