> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [medium.com](https://medium.com/mobis3c/setting-up-an-android-pentesting-environment-29991aa0c3f1)

> Android pentesting requires a dedicated environment which provides access to a rooted android device ......

Setting up an Android Pentesting Environment
============================================

[![](https://miro.medium.com/fit/c/96/96/1*uTzz4c17GKaaSp47mMSkgw.jpeg)](https://3kal.medium.com/?source=post_page-----29991aa0c3f1--------------------------------)[Kal](https://3kal.medium.com/?source=post_page-----29991aa0c3f1--------------------------------)Follow[Feb 5](/mobis3c/setting-up-an-android-pentesting-environment-29991aa0c3f1?source=post_page-----29991aa0c3f1--------------------------------) · 4 min read

Android pentesting requires a dedicated environment which provides access to a rooted android device and let us see how to setup easily by using free tools.

Genymotion
==========

When starting out learning, android emulators are the great way to get experience with a variety of devices having different API levels without costing much and Genymotion provides exactly that with great User Experience and easy to configure nature for free.

> **_Note:_** _VirtualBox is used as a core by genymotion to virtualize Android operating systems. So please install VirtualBox in your system in order to proceed:_ [_link_](https://www.virtualbox.org/wiki/Downloads)

Genymotion requires user registration to use its dashboard and for that first you need to create an account: [link](https://www.genymotion.com/account/create/)

After completing your registration process download its installer from [here](https://www.genymotion.com/download/) and install it in your host computer.

```
#make it executable
chmod +x genymotion-3.2.X-linux_x64.bin
#specify installation path
./genymotion-3.2.X-linux_x64.bin -d <Genymotion_install_path>
cd <Genymotion_install_path>
#run from the installed path
./genymotion

```

Once Genymotion is installed, you can sign in using your credentials specified in the registration process.

you can install a new device by clicking on plus icon at the top right corner and selecting your desired template and keep network mode Bridged

![](https://miro.medium.com/max/46/1*GDSLH64dvsK0Pww0xiEq8A.png?q=20)![](https://miro.medium.com/max/814/1*GDSLH64dvsK0Pww0xiEq8A.png)![](https://miro.medium.com/max/1302/1*GDSLH64dvsK0Pww0xiEq8A.png)

> If some app contains ARM native code, then Genymotion will not be able to run the app as it consists of x86 (32-bit) architecture and will throw an error. You can avoid this problem by installing ARM translation library into emulated device: [link](https://github.com/m9rco/Genymotion_ARM_Translation)
> 
> **_Note:_** _At this point of time this library only supports up to android version 8.0 so download right package according to your emulated device’s specifications._

Once the device is started, select wifi from genymotion options and select wifi to enable network emulation.

select OpenGapps to install Google apps Or in the case of **Archive Error** download gapps file manually from their official [site](https://www.opengapps.org/) to your PC.

Before downloading, check the architecture of mobile, in the terminal run:

```
sudo apt update
sudo apt install adb
adb shell
getprop | grep abi
#architecture can be found in []

```

Download the exact gapps for the architecture from their site and extract the files in your system and then drag and drop the files to the device.

Burp Suite
==========

Open Burpsuite and navigate to Proxy -> Options. In proxy listeners section, click on add and in Binding section give the binding port and set bind to address to “all interfaces” and click ok.

![](https://miro.medium.com/max/60/1*-qpQwcbxCLBcfePdhgzjxQ.png?q=20)![](https://miro.medium.com/max/875/1*-qpQwcbxCLBcfePdhgzjxQ.png)![](https://miro.medium.com/max/1400/1*-qpQwcbxCLBcfePdhgzjxQ.png)

goto proxy and export the certificate as shown

![](https://miro.medium.com/max/60/1*HshTDfiz_Y10wO2aKkvRhA.png?q=20)![](https://miro.medium.com/max/875/1*HshTDfiz_Y10wO2aKkvRhA.png)![](https://miro.medium.com/max/1400/1*HshTDfiz_Y10wO2aKkvRhA.png)cert export

```
#check if device is connected
adb devices -l
#check for ip address
ip a

```

In Android device, Go to Settings → Network & Internet → WiFi and then Click on gear icon next to AndroidWifi. Now, Click on Edit button → Advanced Options → Proxy → Manual.

Add your system ip address in proxy hostname and bind port as port number and Save.

![](https://miro.medium.com/max/30/1*1Z6ZdRJsZJ_lASBWO_fsgg.png?q=20)![](https://miro.medium.com/max/543/1*1Z6ZdRJsZJ_lASBWO_fsgg.png)![](https://miro.medium.com/max/868/1*1Z6ZdRJsZJ_lASBWO_fsgg.png)

Traditional way of installing burp cert wont work in recent android versions.

So we need to install the burp cert as system level cert to work.

![](https://miro.medium.com/max/60/1*XR6EhUgRkzMiyMTZd5v-VQ.png?q=20)![](https://miro.medium.com/max/810/1*XR6EhUgRkzMiyMTZd5v-VQ.png)![](https://miro.medium.com/max/1296/1*XR6EhUgRkzMiyMTZd5v-VQ.png)convert the ca![](https://miro.medium.com/max/60/1*QctwUcawgpemoBKG98-qTA.png?q=20)![](https://miro.medium.com/max/625/1*QctwUcawgpemoBKG98-qTA.png)![](https://miro.medium.com/max/1000/1*QctwUcawgpemoBKG98-qTA.png)puch ca to device![](https://miro.medium.com/max/60/1*SJUL9FcSTBfAQhJy7zTd1w.png?q=20)![](https://miro.medium.com/max/684/1*SJUL9FcSTBfAQhJy7zTd1w.png)![](https://miro.medium.com/max/1094/1*SJUL9FcSTBfAQhJy7zTd1w.png)install ca as system & reboot

APKTool
=======

A tool for reverse engineering 3rd party, closed, binary Android apps. It can decode resources to nearly original form and rebuild them after making some modifications. It also makes working with an app easier because of the project like file structure and automation of some repetitive tasks like building apk, etc.

1.  Download Linux [wrapper script](https://raw.githubusercontent.com/iBotPeaches/Apktool/master/scripts/linux/apktool) (Right click, Save Link As `apktool`)
2.  Download apktool-2 ([find newest here](https://bitbucket.org/iBotPeaches/apktool/downloads/))
3.  Rename downloaded jar to `apktool.jar`
4.  Move both files (`apktool.jar` & `apktool`) to `/usr/local/bin` (root needed)
5.  Make sure both files are executable (`chmod +x`)
6.  Try running apktool via cli

APKSigner
=========

```
sudo apt install -y apksigner

```

Jadx
====

Command line and GUI tools for producing Java source code from Android Dex and Apk files

```
git clone https://github.com/skylot/jadx.git
cd jadx
./gradlew dist
alias jadx-gui="~/jadx/build/jadx/bin/jadx-gui"

```

PID Cat
=======

**Process ID (PID) Cat** is a logcat script which only shows log entries for processes from a specific application package.

Installing PID Cat:

```
#Download pidcat & make it executable
sudo wget -O /usr/local/bin/pidcat https://raw.githubusercontent.com/JakeWharton/pidcat/master/pidcat.py && sudo chmod +x /usr/local/bin/pidcat

```

Check out [Insecure Data Storage: Hardcoded secrets](/mobis3c/insecure-data-storage-clear-text-storage-of-sensitive-information-hard-coded-strings-fb7b056c0d0)